---
title: "SEIR"
output: html_notebook
---
## Model

We use a dynamic epidemiological model, based on the classic SEIR model, to describe the spread and clinical progression of COVID-19. Susceptible ($S$) individuals who become infected start out in an exposed class $E$, where they are asymptomatic and do not transmit infection. The rate of progressing from the exposed stage to the infected stage $I$, where the individual is symptomatic and infectious, occurs at rate $a$. The clinical descriptions of the different stages of infection are given below. Infected individuals begin with *mild* infection ($I_1$), from which they either recover, at rate $\gamma_1$, or progress to *severe* infection ($I_2$), at rate $p_1$. Severe infection resolves at rate $\gamma_2$ or progresses to a critical stage ($I_3$) at rate $p_2$. Individuals with critical infection recover at rate $\gamma_3$ and die at rate $q$. Recovered individuals are tracked by class $R$ and are assumed to return to the infected system at the rate $\delta$. Individuals may transmit the infection at stage $I_1$ with the transmission rate $\beta$. And assume that individuals in stage $I_2$ and $I_3$ have been treated in the hospital, so they are not able to infect susceptible individuals $S$.
 
### Equations

\begin{equation}
\frac{dS}{dt} = -\frac{\beta I_1 S}{N}+\delta R 
\end{equation}

\begin{equation}
\frac{dE}{dt} =\frac{\beta I_1 S}{N} - \alpha E \\
\end{equation}

\begin{equation}
\frac{dI_1}{dt} = \alpha E - \gamma_1 I_1 - p_1 I_1 \\
\end{equation}

\begin{equation}
\frac{dI_2}{dt} = p_1 I_1 -\gamma_2 I_2 - p_2 I_2 \\
\end{equation}

\begin{equation}
\frac{dI_3}{dt}  = p_2 I_2 -\gamma_3 I_3 - q I_3 \\
\end{equation}

\begin{equation}
\frac{dR}{dt}  = \gamma_1 I_1 + \gamma_2 I_2 + \gamma_3 I_3 -\delta R \\
\end{equation}


### Variables
* $S$: Susceptible individuals
* $E$: Exposed individuals - infected but not yet infectious or symptomatic
* $I_i$: Infected individuals in severity class $i$. Severity increaes with $i$ and we assume individuals must pass through all previous classes
  * $I_1$: Mild infection 
  * $I_2$: Severe infection 
  * $I_3$: Critical infection 
* $R$: individuals who have recovered from disease and are now immune
* $D$: Dead individuals
* $N$: Total population size (time-varying), where $N=S+E+I_1+I_2+I_3+R$ 

### Parameters
* $\beta$ rate at which infected individuals in class $I_1$ contact susceptibles and infect them
* $\alpha$ rate of progression from the exposed to infected class
* $\gamma_i$ rate at which infected individuals in class $I_i$ recover from disease and become immune
* $p_i$ rate at which infected individuals in class $I_i$ progress to class $I_{i+1}$
* $q$ death rate for individuals in the most severe stage of disease
* $\delta$ rate of progression from the recovered to susceptible class

### Clinical stages

* Mild infection - These individuals have symptoms like fever and cough and may have mild pneumonia.  Hospitalization is not required (though in many countries such individuals are also hospitalized)
* Severe infection - These individuals have more severe pneumonia that leads to dyspnea, respiratory frequency <30/min, blood oxygen saturation <93%, partial pressure of arterial oxygen to fraction of inspired oxygen ratio <300, and/or lung infiltrates >50% within 24 to 48 hours. Hospitalization and supplemental oxygen are generally required.
* Critical infection - These individuals experience respiratory failure, septic shock, and/or multiple organ dysfunction or failure. Treatment in an ICU, often with mechanical ventilation, is required.


### Relating clinical observations to model parameters

To determine the model parameters consistent with current clinical data, we collect the following values from the slider values chosen by the user, and then use the formulas below to relate them to the rate parameters in the model. Note that the slider inputs for time intervals are averages durations. 

* IncubPeriod:  Average incubation period, days
* DurMildInf: Average duration of mild infections, days
* FracMild: Average fraction of (symptomatic) infections that are mild
* FracSevere: Average fraction of (symptomatic) infections that are severe
* FracCritical: Average fraction of (symptomatic) infections that are critical
* CFR: Case fatality rate (fraction of infections that eventually result in death)
* DurHosp: Average duration of hospitalization for individuals with severe/critical infection, days
* TimeICUDeath: Average time from ICU admission to death, days

Note that

* $\alpha$=1/IncubPeriod

* $\gamma_1$=(1/DurMildInf)*FracMild
* $p_1$=(1/DurMildInf)-$\gamma_1$

* $p_2$=(1/DurHosp)*(FracCritical/(FracSevere+FracCritical))
* $\gamma_2$=(1/DurHosp)-$p_2$

* $q$=(1/TimeICUDeath)*(CFR/FracCritical)
* $\gamma_3$=(1/TimeICUDeath)-$q$




### Basic reproductive ratio

Idea:

\begin{equation}
R_0  = \frac{\beta}{p_1+\gamma_1}
\end{equation}

### Early epidemic growth rate

Early in the epidemic, before susceptibles are depleted, the epidemic grows at an exponential rate $r$, which can also be described with doubling time T$_2$=ln(2)$/r$.

### Assumptions

* This model is formulated as a system of differential equations and the output therefore represents the expected values of each quantity. It does not take into account stochastic events or report the expected variance in the variables, which can be large. 
* Individuals must pass through a mild stage before reaching a severe or critical stage
* Individuals must pass through a severe stage before reaching a critical stage
* Only individuals in a critical stage die
* 

