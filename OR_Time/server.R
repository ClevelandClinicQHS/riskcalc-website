require(shiny)

interval.pred <- function(pred, actual, lower, upper){
  plot(0, type='n', axes=F, xlab="", ylab="", ylim=c(0,max(upper, actual) + 100), xlim=c(0,1))
  axis(1, c(0,1), labels=F)
  axis(2, seq(0,max(upper, actual) + 100, by=100))
  
  points(0.5, pred, pch=15, cex=3)
  text(0.6, pred, paste(pred))
  lines(c(0.5, 0.5), c(lower, upper))
  lines(c(0.475, 0.525), c(upper, upper))
  text(0.6, upper, paste(upper))
  lines(c(0.475, 0.525), c(lower, lower))
  text(0.6, lower, paste(lower))
  
  points(0.5, actual, pch=19, cex=3, col=ifelse(actual < lower, "Dark Green", ifelse(actual >= lower & actual <= upper, "Yellow2", "Red")))
  text(0.4, actual, paste(actual), col=ifelse(actual < lower, "Dark Green", ifelse(actual >= lower & actual <= upper, "Yellow2", "Red")), cex=1.5)
}

Pred.SE <- function(pred){
  sqrt(6821.358*(1 + (1/57120) + (((pred - 151.7)^2)/359619203)))
}


formula.OR.Time <- expression({
           lp <- 301.49314 - 0.83649847 * (Admit_Type == "Elective and Inpatient") - 
             20.289335 * (Admit_Type == "Emergency hospital") - 246.19337 * 
             (msdrg == "100") - 264.38132 * (msdrg == "101") - 221.22424 * 
             (msdrg == "103") - 49.603297 * (msdrg == "11") - 139.01233 * 
             (msdrg == "113") - 110.13951 * (msdrg == "114") - 236.11776 * 
             (msdrg == "115") - 189.68275 * (msdrg == "116") - 202.46859 * 
             (msdrg == "117") + 49.633885 * (msdrg == "12") + 16.241493 * 
             (msdrg == "129") - 135.51679 * (msdrg == "13") - 54.845139 * 
             (msdrg == "130") - 47.562982 * (msdrg == "131") - 16.595225 * 
             (msdrg == "132") - 169.12896 * (msdrg == "133") - 196.03049 * 
             (msdrg == "134") - 64.121798 * (msdrg == "139") - 201.07248 * 
             (msdrg == "14") - 275.33581 * (msdrg == "154") - 264.63552 * 
             (msdrg == "155") - 133.16554 * (msdrg == "163") - 83.835629 * 
             (msdrg == "164") - 106.94387 * (msdrg == "165") - 220.41187 * 
             (msdrg == "166") - 233.60742 * (msdrg == "167") - 207.77857 * 
             (msdrg == "168") - 270.2963 * (msdrg == "175") - 258.19588 * 
             (msdrg == "176") - 267.82075 * (msdrg == "177") - 262.49838 * 
             (msdrg == "178") - 262.53011 * (msdrg == "180") - 250.42718 * 
             (msdrg == "181") - 245.1065 * (msdrg == "187") - 257.33052 * 
             (msdrg == "189") - 262.81305 * (msdrg == "190") - 262.81056 * 
             (msdrg == "191") - 257.16498 * (msdrg == "192") - 269.1168 * 
             (msdrg == "193") - 265.78409 * (msdrg == "194") - 268.3626 * 
             (msdrg == "195") - 258.38596 * (msdrg == "196") + 149.8488 * 
             (msdrg == "2") - 103.34014 * (msdrg == "20") - 271.99505 * 
             (msdrg == "202") - 267.29052 * (msdrg == "204") - 268.13724 * 
             (msdrg == "205") - 241.21733 * (msdrg == "206") - 261.34044 * 
             (msdrg == "207") - 262.09081 * (msdrg == "208") - 87.974624 * 
             (msdrg == "21") + 33.921782 * (msdrg == "216") + 45.600627 * 
             (msdrg == "217") + 16.642004 * (msdrg == "219") + 18.439602 * 
             (msdrg == "220") - 13.464565 * (msdrg == "221") - 145.28574 * 
             (msdrg == "222") - 160.99804 * (msdrg == "224") - 147.88142 * 
             (msdrg == "226") - 185.73719 * (msdrg == "227") + 11.200947 * 
             (msdrg == "228") - 12.179673 * (msdrg == "229") - 162.18625 * 
             (msdrg == "23") - 113.08806 * (msdrg == "230") - 1.0146705 * 
             (msdrg == "231") + 37.527697 * (msdrg == "232") - 30.145437 * 
             (msdrg == "233") + 18.360735 * (msdrg == "234") + 42.139947 * 
             (msdrg == "235") + 70.868299 * (msdrg == "236") - 86.59113 * 
             (msdrg == "237") - 88.909602 * (msdrg == "238") - 199.02544 * 
             (msdrg == "239") - 96.02019 * (msdrg == "24") - 186.44911 * 
             (msdrg == "240") - 214.21038 * (msdrg == "241") - 192.24373 * 
             (msdrg == "242") - 199.71592 * (msdrg == "243") - 191.50754 * 
             (msdrg == "244") - 204.82583 * (msdrg == "246") - 210.92317 * 
             (msdrg == "247") - 188.8072 * (msdrg == "248") - 216.36312 * 
             (msdrg == "249") - 99.115575 * (msdrg == "25") - 136.40241 * 
             (msdrg == "250") - 143.29398 * (msdrg == "251") - 155.36705 * 
             (msdrg == "252") - 143.09273 * (msdrg == "253") - 135.79751 * 
             (msdrg == "254") - 239.03412 * (msdrg == "255") - 254.89058 * 
             (msdrg == "256") - 115.49201 * (msdrg == "26") - 180.71469 * 
             (msdrg == "264") - 89.736212 * (msdrg == "27") - 94.683838 * 
             (msdrg == "28") - 247.61814 * (msdrg == "280") - 237.45834 * 
             (msdrg == "281") - 247.48426 * (msdrg == "282") - 233.24051 * 
             (msdrg == "286") - 232.26956 * (msdrg == "287") - 238.5825 * 
             (msdrg == "288") - 90.851723 * (msdrg == "29") - 260.66369 * 
             (msdrg == "291") - 258.57189 * (msdrg == "292") - 255.37666 * 
             (msdrg == "299") - 154.58043 * (msdrg == "3") - 117.84265 * 
             (msdrg == "30") - 237.15189 * (msdrg == "300") - 242.53788 * 
             (msdrg == "301") - 226.86765 * (msdrg == "308") - 250.2303 * 
             (msdrg == "309") - 156.85134 * (msdrg == "31") - 257.8087 * 
             (msdrg == "310") - 261.01812 * (msdrg == "312") - 273.84491 * 
             (msdrg == "313") - 252.99448 * (msdrg == "314") - 240.37528 * 
             (msdrg == "315") - 237.81257 * (msdrg == "316") - 178.8819 * 
             (msdrg == "32") - 124.59643 * (msdrg == "326") - 133.00687 * 
             (msdrg == "327") - 180.02289 * (msdrg == "328") - 122.20937 * 
             (msdrg == "329") - 178.10557 * (msdrg == "33") - 110.41833 * 
             (msdrg == "330") - 110.99769 * (msdrg == "331") - 63.054194 * 
             (msdrg == "332") - 33.757746 * (msdrg == "333") - 117.95154 * 
             (msdrg == "334") - 127.6617 * (msdrg == "335") - 146.4709 * 
             (msdrg == "336") - 154.23155 * (msdrg == "337") - 146.31357 * 
             (msdrg == "338") - 204.71974 * (msdrg == "339") - 218.20485 * 
             (msdrg == "340") - 168.59248 * (msdrg == "341") - 209.0241 * 
             (msdrg == "342") - 228.8899 * (msdrg == "343") - 193.89547 * 
             (msdrg == "344") - 199.6833 * (msdrg == "345") - 206.08515 * 
             (msdrg == "346") - 251.31496 * (msdrg == "347") - 249.69036 * 
             (msdrg == "348") - 239.38524 * (msdrg == "349") - 154.28571 * 
             (msdrg == "35") - 170.44622 * (msdrg == "350") - 203.38822 * 
             (msdrg == "351") - 206.61369 * (msdrg == "352") - 155.58229 * 
             (msdrg == "353") - 161.33054 * (msdrg == "354") - 193.88259 * 
             (msdrg == "355") - 231.79619 * (msdrg == "356") - 212.43701 * 
             (msdrg == "357") - 214.60106 * (msdrg == "358") - 157.11246 * 
             (msdrg == "36") - 262.53008 * (msdrg == "368") - 264.0448 * 
             (msdrg == "369") - 92.466434 * (msdrg == "37") - 264.43129 * 
             (msdrg == "370") - 255.17484 * (msdrg == "371") - 267.98562 * 
             (msdrg == "372") - 257.41318 * (msdrg == "374") - 261.83921 * 
             (msdrg == "375") - 264.16686 * (msdrg == "376") - 258.88919 * 
             (msdrg == "377") - 261.56924 * (msdrg == "378") - 264.6531 * 
             (msdrg == "379") - 113.60045 * (msdrg == "38") - 258.49299 * 
             (msdrg == "380") - 268.2424 * (msdrg == "381") - 270.73677 * 
             (msdrg == "383") - 274.33338 * (msdrg == "384") - 262.75654 * 
             (msdrg == "385") - 257.09829 * (msdrg == "386") - 259.05093 * 
             (msdrg == "387") - 267.73496 * (msdrg == "388") - 268.64321 * 
             (msdrg == "389") - 114.63786 * (msdrg == "39") - 265.43722 * 
             (msdrg == "390") - 265.07049 * (msdrg == "391") - 269.05928 * 
             (msdrg == "392") - 255.0142 * (msdrg == "393") - 262.18607 * 
             (msdrg == "394") - 254.62966 * (msdrg == "395") - 254.39881 * 
             (msdrg == "4") - 234.9058 * (msdrg == "40") - 40.933455 * 
             (msdrg == "405") + 10.677757 * (msdrg == "406") - 21.746973 * 
             (msdrg == "407") - 18.421931 * (msdrg == "408") - 52.703476 * 
             (msdrg == "409") - 217.56126 * (msdrg == "41") - 154.86058 * 
             (msdrg == "411") - 124.34361 * (msdrg == "414") - 158.75534 * 
             (msdrg == "415") - 146.1086 * (msdrg == "416") - 197.16484 * 
             (msdrg == "417") - 200.49959 * (msdrg == "418") - 208.67724 * 
             (msdrg == "419") - 193.77399 * (msdrg == "42") - 220.5427 * 
             (msdrg == "420") - 192.04584 * (msdrg == "421") - 242.28193 * 
             (msdrg == "423") - 253.99197 * (msdrg == "432") - 280.77771 * 
             (msdrg == "433") - 235.29763 * (msdrg == "435") - 231.4928 * 
             (msdrg == "436") - 251.05666 * (msdrg == "438") - 265.04367 * 
             (msdrg == "439") - 262.24766 * (msdrg == "440") - 258.40755 * 
             (msdrg == "441") - 248.71252 * (msdrg == "442") - 246.60301 * 
             (msdrg == "444") - 243.50798 * (msdrg == "445") - 252.80089 * 
             (msdrg == "446") + 28.5837 * (msdrg == "453") + 78.996629 * 
             (msdrg == "454") + 47.611895 * (msdrg == "455") + 45.590308 * 
             (msdrg == "456") + 58.964888 * (msdrg == "457") + 90.332403 * 
             (msdrg == "458") - 55.38222 * (msdrg == "459") - 41.199498 * 
             (msdrg == "460") - 139.42098 * (msdrg == "461") - 101.67595 * 
             (msdrg == "462") - 150.26313 * (msdrg == "463") - 140.60266 * 
             (msdrg == "464") - 105.18178 * (msdrg == "465") - 101.30155 * 
             (msdrg == "466") - 113.45728 * (msdrg == "467") - 139.56308 * 
             (msdrg == "468") - 170.46679 * (msdrg == "469") - 172.22912 * 
             (msdrg == "470") - 79.136715 * (msdrg == "471") - 69.552499 * 
             (msdrg == "472") - 89.388696 * (msdrg == "473") - 184.16112 * 
             (msdrg == "474") - 184.58832 * (msdrg == "475") - 209.36599 * 
             (msdrg == "476") - 212.75218 * (msdrg == "477") - 186.77042 * 
             (msdrg == "478") - 219.42737 * (msdrg == "479") - 184.81429 * 
             (msdrg == "480") - 183.75231 * (msdrg == "481") - 194.36646 * 
             (msdrg == "482") - 129.75451 * (msdrg == "483") - 142.18105 * 
             (msdrg == "484") - 156.77079 * (msdrg == "485") - 173.21393 * 
             (msdrg == "486") - 212.73428 * (msdrg == "487") - 175.72858 * 
             (msdrg == "488") - 185.15744 * (msdrg == "489") - 106.64027 * 
             (msdrg == "490") - 114.41121 * (msdrg == "491") - 167.13751 * 
             (msdrg == "492") - 144.81955 * (msdrg == "493") - 143.81055 * 
             (msdrg == "494") - 181.46155 * (msdrg == "495") - 213.2709 * 
             (msdrg == "496") - 159.67858 * (msdrg == "497") - 174.66041 * 
             (msdrg == "498") + 195.39756 * (msdrg == "5") - 207.58858 * 
             (msdrg == "500") - 219.7207 * (msdrg == "501") - 196.60859 * 
             (msdrg == "502") - 249.20731 * (msdrg == "503") - 251.704 * 
             (msdrg == "504") - 128.42147 * (msdrg == "505") - 180.44032 * 
             (msdrg == "507") - 194.03762 * (msdrg == "511") - 198.17143 * 
             (msdrg == "512") - 215.80845 * (msdrg == "513") - 257.39039 * 
             (msdrg == "514") - 179.22653 * (msdrg == "515") - 161.93105 * 
             (msdrg == "516") - 160.95118 * (msdrg == "517") - 168.56538 * 
             (msdrg == "54") - 267.05488 * (msdrg == "542") - 259.98594 * 
             (msdrg == "543") - 261.97738 * (msdrg == "546") - 155.05803 * 
             (msdrg == "55") - 270.97077 * (msdrg == "552") - 225.58285 * 
             (msdrg == "559") - 263.95516 * (msdrg == "56") - 220.96699 * 
             (msdrg == "560") - 280.09649 * (msdrg == "561") - 258.45582 * 
             (msdrg == "563") - 227.30192 * (msdrg == "570") - 241.38587 * 
             (msdrg == "571") - 246.51396 * (msdrg == "572") - 261.43661 * 
             (msdrg == "574") - 73.998667 * (msdrg == "576") - 107.29789 * 
             (msdrg == "577") - 154.96722 * (msdrg == "578") - 220.14569 * 
             (msdrg == "579") - 176.48778 * (msdrg == "580") - 44.11724 * 
             (msdrg == "581") - 126.55229 * (msdrg == "582") - 53.986201 * 
             (msdrg == "583") + 96.690057 * (msdrg == "584") + 78.669013 * 
             (msdrg == "585") + 228.72054 * (msdrg == "6") - 276.18292 * 
             (msdrg == "601") - 256.77375 * (msdrg == "602") - 266.834 * 
             (msdrg == "603") - 260.21898 * (msdrg == "605") - 65.874078 * 
             (msdrg == "614") - 71.461987 * (msdrg == "615") - 207.35874 * 
             (msdrg == "616") - 241.99478 * (msdrg == "617") - 105.72532 * 
             (msdrg == "619") - 149.10695 * (msdrg == "620") - 178.79441 * 
             (msdrg == "621") - 199.71602 * (msdrg == "622") - 204.50405 * 
             (msdrg == "623") - 8.0255356 * (msdrg == "625") - 99.578752 * 
             (msdrg == "626") - 114.83402 * (msdrg == "627") - 211.20638 * 
             (msdrg == "628") - 205.26102 * (msdrg == "629") - 138.99034 * 
             (msdrg == "630") - 262.03589 * (msdrg == "637") - 263.67426 * 
             (msdrg == "638") - 244.96325 * (msdrg == "64") - 264.2053 * 
             (msdrg == "640") - 242.2764 * (msdrg == "641") - 268.94949 * 
             (msdrg == "643") - 237.1088 * (msdrg == "65") + 22.080474 * 
             (msdrg == "652") + 66.32872 * (msdrg == "653") + 99.861557 * 
             (msdrg == "654") + 149.07273 * (msdrg == "655") - 93.392348 * 
             (msdrg == "656") - 42.224217 * (msdrg == "657") - 42.235038 * 
             (msdrg == "658") - 160.77294 * (msdrg == "659") - 212.76025 * 
             (msdrg == "66") - 131.86047 * (msdrg == "660") - 116.74603 * 
             (msdrg == "661") - 222.27801 * (msdrg == "663") - 165.34657 * 
             (msdrg == "664") - 224.06185 * (msdrg == "668") - 233.78079 * 
             (msdrg == "669") - 240.56549 * (msdrg == "670") - 218.94793 * 
             (msdrg == "671") - 130.89488 * (msdrg == "672") - 193.05474 * 
             (msdrg == "673") - 196.15242 * (msdrg == "674") - 154.14949 * 
             (msdrg == "675") - 261.75168 * (msdrg == "682") - 264.63084 * 
             (msdrg == "683") - 274.33369 * (msdrg == "684") - 259.43782 * 
             (msdrg == "689") - 235.6376 * (msdrg == "69") - 262.00555 * 
             (msdrg == "690") - 262.92761 * (msdrg == "693") - 256.88387 * 
             (msdrg == "694") - 262.93674 * (msdrg == "696") - 262.09466 * 
             (msdrg == "698") - 248.86622 * (msdrg == "699") + 6.3861655 * 
             (msdrg == "7") - 30.310731 * (msdrg == "707") - 31.92062 * 
             (msdrg == "708") - 221.2513 * (msdrg == "709") - 141.32721 * 
             (msdrg == "710") - 212.61207 * (msdrg == "711") - 220.0217 * 
             (msdrg == "713") - 219.5131 * (msdrg == "714") - 135.87079 * 
             (msdrg == "715") - 254.50169 * (msdrg == "717") - 249.82281 * 
             (msdrg == "728") - 264.27167 * (msdrg == "73") - 49.898878 * 
             (msdrg == "734") - 120.2128 * (msdrg == "735") - 141.1994 * 
             (msdrg == "736") - 131.51103 * (msdrg == "737") - 133.49868 * 
             (msdrg == "738") - 62.300859 * (msdrg == "739") - 272.92239 * 
             (msdrg == "74") - 123.84025 * (msdrg == "740") - 138.10869 * 
             (msdrg == "741") - 143.09758 * (msdrg == "742") - 163.38466 * 
             (msdrg == "743") - 243.80269 * (msdrg == "744") - 204.01094 * 
             (msdrg == "745") - 201.99918 * (msdrg == "746") - 218.63614 * 
             (msdrg == "747") - 56.54193 * (msdrg == "748") - 152.95657 * 
             (msdrg == "749") - 168.47969 * (msdrg == "750") - 204.5798 * 
             (msdrg == "765") - 215.42933 * (msdrg == "766") - 226.34665 * 
             (msdrg == "767") - 220.73666 * (msdrg == "769") - 237.65405 * 
             (msdrg == "770") - 249.30681 * (msdrg == "774") - 231.5447 * 
             (msdrg == "775") - 201.14598 * (msdrg == "777") - 217.5488 * 
             (msdrg == "781") - 208.0053 * (msdrg == "789") - 199.3858 * 
             (msdrg == "790") - 154.60884 * (msdrg == "791") - 98.526465 * 
             (msdrg == "793") - 129.8065 * (msdrg == "799") + 105.09739 * 
             (msdrg == "8") - 154.05732 * (msdrg == "800") - 99.831304 * 
             (msdrg == "801") - 242.21895 * (msdrg == "802") - 178.94156 * 
             (msdrg == "803") - 234.01364 * (msdrg == "804") - 266.39705 * 
             (msdrg == "809") - 267.11994 * (msdrg == "811") - 263.31951 * 
             (msdrg == "812") - 143.41978 * (msdrg == "820") - 122.60781 * 
             (msdrg == "821") - 115.57522 * (msdrg == "822") - 196.24011 * 
             (msdrg == "823") - 191.62903 * (msdrg == "824") - 235.04719 * 
             (msdrg == "825") - 96.614344 * (msdrg == "826") - 33.316073 * 
             (msdrg == "827") - 126.95905 * (msdrg == "828") - 200.81392 * 
             (msdrg == "829") - 281.51061 * (msdrg == "830") - 249.07669 * 
             (msdrg == "834") - 260.4375 * (msdrg == "839") - 243.6813 * 
             (msdrg == "840") - 260.93705 * (msdrg == "841") - 269.88059 * 
             (msdrg == "847") - 199.41471 * (msdrg == "853") - 211.8585 * 
             (msdrg == "854") - 171.91929 * (msdrg == "856") - 215.32173 * 
             (msdrg == "857") - 222.8131 * (msdrg == "858") - 247.4353 * 
             (msdrg == "862") - 239.7355 * (msdrg == "863") - 270.43648 * 
             (msdrg == "867") - 270.57121 * (msdrg == "870") - 259.75772 * 
             (msdrg == "871") - 252.79594 * (msdrg == "872") - 281.03393 * 
             (msdrg == "885") - 251.80846 * (msdrg == "902") - 119.49187 * 
             (msdrg == "903") - 149.12653 * (msdrg == "904") - 196.47474 * 
             (msdrg == "905") - 157.89882 * (msdrg == "907") - 180.10628 * 
             (msdrg == "908") - 185.35901 * (msdrg == "909") - 244.87252 * 
             (msdrg == "91") - 275.55225 * (msdrg == "917") - 238.19152 * 
             (msdrg == "919") - 211.76013 * (msdrg == "92") - 220.34027 * 
             (msdrg == "920") - 250.02737 * (msdrg == "921") - 205.66964 * 
             (msdrg == "93") - 200.95314 * (msdrg == "939") - 170.84087 * 
             (msdrg == "940") - 51.833144 * (msdrg == "941") - 266.36238 * 
             (msdrg == "945") - 241.58977 * (msdrg == "948") - 248.1185 * 
             (msdrg == "949") - 175.72457 * (msdrg == "956") - 154.65642 * 
             (msdrg == "957") - 91.964158 * (msdrg == "958") - 258.24111 * 
             (msdrg == "974") - 179.79762 * (msdrg == "981") - 192.87162 * 
             (msdrg == "982") - 146.80432 * (msdrg == "983") - 239.08602 * 
             (msdrg == "987") - 235.0212 * (msdrg == "988") - 211.5061 * 
             (msdrg == "989") + 45.122338 * (Trainees == "Yes") + 
             0.33052854 * (Day_of_week == "Monday") - 15.1815 * (Day_of_week == "Saturday") - 14.274509 * (Day_of_week == "Sunday") + 
             3.5482309 * (Day_of_week == "Thursday") + 2.4185701 * (Day_of_week == "Tuesday") + 4.4763444 * (Day_of_week == "Wednesday");
             
    })

# Define server logic required to summarize and view the selected dataset
shinyServer(function(input, output) {

  # Return the requested dataset

  get_newdata <- reactive({
    new.dat <- data.frame(Admit_Type = factor(input$Admit_Type, levels = c("Ambulatory outpatient and Observation", "Elective and Inpatient", "Emergency hospital")),
                          Actual_OR_Time = input$Actual_OR_Time,
                          Trainees = factor(input$Trainees, levels = c("Yes", "No")),
                          Day_of_week = factor(input$Day_of_week, levels = c("Friday", "Monday", "Saturday", "Sunday", "Thursday", "Tuesday", "Wednesday")),
                          msdrg = factor(input$msdrg, levels = c("1",  "2",  "3",	"4",	"5",	"6",	"7",	"8",	"11",	"12",	"13",	"14",	"20",	"21",	"23",	"24",	"25",	"26",	"27",	"28",	"29",	"30",	
                                                                 "31",	"32",	"33",	"35",	"36",	"37",	"38",	"39",	"40",	"41",	"42",	"54",	"55",	"56",	"64",	"65",	"66",	"69",	"73",	"74",	"91",	"92",	
                                                                 "93",	"100",	"101",	"103",	"113",	"114",	"115",	"116",	"117",	"129",	"130",	"131",	"132",	"133",	"134",	"139",	"154",	
                                                                 "155",	"163",	"164",	"165",	"166",	"167",	"168",	"175",	"176",	"177",	"178",	"180",	"181",	"187",	"189",	"190",	"191",	
                                                                 "192",	"193",	"194",	"195",	"196",	"202",	"204",	"205",	"206",	"207",	"208",	"216",	"217",	"219",	"220",	"221",	"222",	
                                                                 "224",	"226",	"227",	"228",	"229",	"230",	"231",	"232",	"233",	"234",	"235",	"236",	"237",	"238",	"239",	"240",	"241",	
                                                                 "242",	"243",	"244",	"246",	"247",	"248",	"249",	"250",	"251",	"252",	"253",	"254",	"255",	"256",	"264",	"280",	"281",	
                                                                 "282",	"286",	"287",	"288",	"291",	"292",	"299",	"300",	"301",	"308",	"309",	"310",	"312",	"313",	"314",	"315",	"316",	
                                                                 "326",	"327",	"328",	"329",	"330",	"331",	"332",	"333",	"334",	"335",	"336",	"337",	"338",	"339",	"340",	"341",	"342",	
                                                                 "343",	"344",	"345",	"346",	"347",	"348",	"349",	"350",	"351",	"352",	"353",	"354",	"355",	"356",	"357",	"358",	"368",	
                                                                 "369",	"370",	"371",	"372",	"374",	"375",	"376",	"377",	"378",	"379",	"380",	"381",	"383",	"384",	"385",	"386",	"387",	
                                                                 "388",	"389",	"390",	"391",	"392",	"393",	"394",	"395",	"405",	"406",	"407",	"408",	"409",	"411",	"414",	"415",	"416",	
                                                                 "417",	"418",	"419",	"420",	"421",	"423",	"432",	"433",	"435",	"436",	"438",	"439",	"440",	"441",	"442",	"444",	"445",	
                                                                 "446",	"453",	"454",	"455",	"456",	"457",	"458",	"459",	"460",	"461",	"462",	"463",	"464",	"465",	"466",	"467",	"468",	
                                                                 "469",	"470",	"471",	"472",	"473",	"474",	"475",	"476",	"477",	"478",	"479",	"480",	"481",	"482",	"483",	"484",	"485",	
                                                                 "486",	"487",	"488",	"489",	"490",	"491",	"492",	"493",	"494",	"495",	"496",	"497",	"498",	"500",	"501",	"502",	"503",	
                                                                 "504",	"505",	"507",	"511",	"512",	"513",	"514",	"515",	"516",	"517",	"542",	"543",	"546",	"552",	"559",	"560",	"561",	
                                                                 "563",	"570",	"571",	"572",	"574",	"576",	"577",	"578",	"579",	"580",	"581",	"582",	"583",	"584",	"585",	"601",	"602",	
                                                                 "603",	"605",	"614",	"615",	"616",	"617",	"619",	"620",	"621",	"622",	"623",	"625",	"626",	"627",	"628",	"629",	"630",	
                                                                 "637",	"638",	"640",	"641",	"643",	"652",	"653",	"654",	"655",	"656",	"657",	"658",	"659",	"660",	"661",	"663",	"664",	
                                                                 "668",	"669",	"670",	"671",	"672",	"673",	"674",	"675",	"682",	"683",	"684",	"689",	"690",	"693",	"694",	"696",	"698",	
                                                                 "699",	"707",	"708",	"709",	"710",	"711",	"713",	"714",	"715",	"717",	"728",	"734",	"735",	"736",	"737",	"738",	"739",	
                                                                 "740",	"741",	"742",	"743",	"744",	"745",	"746",	"747",	"748",	"749",	"750",	"765",	"766",	"767",	"769",	"770",	"774",	
                                                                 "775",	"777",	"781",	"789",	"790",	"791",	"793",	"799",	"800",	"801",	"802",	"803",	"804",	"809",	"811",	"812",	"820",	
                                                                 "821",	"822",	"823",	"824",	"825",	"826",	"827",	"828",	"829",	"830",	"834",	"839",	"840",	"841",	"847",	"853",	"854",	
                                                                 "856",	"857",	"858",	"862",	"863",	"867",	"870",	"871",	"872",	"885",	"902",	"903",	"904",	"905",	"907",	"908",	"909",	
                                                                 "917",	"919",	"920",	"921",	"939",	"940",	"941",	"945",	"948",	"949",	"956",	"957",	"958",	"974",	"981",	"982",	"983",	
                                                                 "987",	"988",	"989"))
    )
    new.dat
  })


  # Generate a summary of the dataset
  output$pred <- renderText({
    new.dat <- get_newdata()
    x <- eval(formula.OR.Time ,envir = new.dat)
    x1 <- round(x,0)
    paste(x1, "minutes", sep=" ")
  })
  
  output$interval <- renderText({
    new.dat <- get_newdata()
    x <- eval(formula.OR.Time ,envir = new.dat)
    se <- Pred.SE(x)
    xl <- round(x - (1.96*se),1)
    xl <- ifelse(xl < 0, 0, xl)
    xu <- round(x + (1.96*se),1)
        
    paste("(", xl, ",", xu, ")", sep=" ")
  })
  
  output$actual <- renderText({
    new.dat <- get_newdata()
    paste(new.dat$Actual_OR_Time, "minutes", sep=" ")
  })
  
  output$interval.plot <- renderPlot({
    new.dat <- get_newdata()
    x <- eval(formula.OR.Time ,envir = new.dat)
    se <- Pred.SE(x)
    xl <- round(x - (1.96*se),1)
    xl <- ifelse(xl < 0, 0, xl)
    xu <- round(x + (1.96*se),1)
    interval.pred(round(x,1), new.dat$Actual_OR_Time, xl, xu)
  })

})
